{% extends 'base_auth.html' %}
{% load static %}
{% load crispy_forms_tags %}

{% block title %}Inscription - Plateforme de Recrutement{% endblock %}

{% block auth_title %}Créer un compte{% endblock %}

{% block auth_subtitle %}Rejoignez notre communauté et trouvez l'emploi de vos rêves{% endblock %}

{% block auth_content %}
<form method="post" class="auth-form">
    {% csrf_token %}
    <div class="form-row">
        <div class="form-group col-md-6">
            <label for="{{ form.first_name.id_for_label }}" class="form-label">
                <i class="fas fa-user"></i>
                <span>Prénom</span>
            </label>
            {{ form.first_name|add_class:"form-control" }}
            {% if form.first_name.errors %}
            <div class="form-errors">
                {% for error in form.first_name.errors %}
                <span class="error-message">{{ error }}</span>
                {% endfor %}
            </div>
            {% endif %}
        </div>
        <div class="form-group col-md-6">
            <label for="{{ form.last_name.id_for_label }}" class="form-label">
                <i class="fas fa-user"></i>
                <span>Nom</span>
            </label>
            {{ form.last_name|add_class:"form-control" }}
            {% if form.last_name.errors %}
            <div class="form-errors">
                {% for error in form.last_name.errors %}
                <span class="error-message">{{ error }}</span>
                {% endfor %}
            </div>
            {% endif %}
        </div>
    </div>

    <div class="form-group">
        <label for="{{ form.email.id_for_label }}" class="form-label">
            <i class="fas fa-envelope"></i>
            <span>Email</span>
        </label>
        {{ form.email|add_class:"form-control" }}
        {% if form.email.errors %}
        <div class="form-errors">
            {% for error in form.email.errors %}
            <span class="error-message">{{ error }}</span>
            {% endfor %}
        </div>
        {% endif %}
    </div>

    <div class="form-group">
        <label for="{{ form.username.id_for_label }}" class="form-label">
            <i class="fas fa-at"></i>
            <span>Nom d'utilisateur</span>
        </label>
        {{ form.username|add_class:"form-control" }}
        {% if form.username.errors %}
        <div class="form-errors">
            {% for error in form.username.errors %}
            <span class="error-message">{{ error }}</span>
            {% endfor %}
        </div>
        {% endif %}
    </div>

    <div class="form-group">
        <label for="{{ form.password1.id_for_label }}" class="form-label">
            <i class="fas fa-lock"></i>
            <span>Mot de passe</span>
        </label>
        <div class="password-input">
            {{ form.password1|add_class:"form-control" }}
            <button type="button" class="password-toggle" id="password1-toggle">
                <i class="fas fa-eye"></i>
            </button>
        </div>
        {% if form.password1.errors %}
        <div class="form-errors">
            {% for error in form.password1.errors %}
            <span class="error-message">{{ error }}</span>
            {% endfor %}
        </div>
        {% endif %}
    </div>

    <div class="form-group">
        <label for="{{ form.password2.id_for_label }}" class="form-label">
            <i class="fas fa-lock"></i>
            <span>Confirmer le mot de passe</span>
        </label>
        <div class="password-input">
            {{ form.password2|add_class:"form-control" }}
            <button type="button" class="password-toggle" id="password2-toggle">
                <i class="fas fa-eye"></i>
            </button>
        </div>
        {% if form.password2.errors %}
        <div class="form-errors">
            {% for error in form.password2.errors %}
            <span class="error-message">{{ error }}</span>
            {% endfor %}
        </div>
        {% endif %}
    </div>

    <div class="form-group">
        <label for="{{ form.user_type.id_for_label }}" class="form-label">
            <i class="fas fa-user-tag"></i>
            <span>Type de compte</span>
        </label>
        {{ form.user_type|add_class:"form-select" }}
        {% if form.user_type.errors %}
        <div class="form-errors">
            {% for error in form.user_type.errors %}
            <span class="error-message">{{ error }}</span>
            {% endfor %}
        </div>
        {% endif %}
    </div>

    <div class="form-options">
        <div class="form-check">
            <input type="checkbox" class="form-check-input" id="terms" name="terms" required>
            <label class="form-check-label" for="terms">
                J'accepte les <a href="{% url 'core:terms' %}" target="_blank">conditions d'utilisation</a> et la <a href="{% url 'core:privacy' %}" target="_blank">politique de confidentialité</a>
            </label>
        </div>
        <div class="form-check">
            <input type="checkbox" class="form-check-input" id="newsletter" name="newsletter">
            <label class="form-check-label" for="newsletter">
                Je souhaite recevoir les actualités et offres par email
            </label>
        </div>
    </div>

    <button type="submit" class="btn btn-primary btn-auth">
        <i class="fas fa-user-plus"></i>
        <span>Créer mon compte</span>
    </button>
</form>
{% endblock %}

{% block auth_footer %}
<div class="auth-footer-content">
    <p>Déjà un compte ? <a href="{% url 'accounts:login' %}">Se connecter</a></p>
    <div class="auth-divider">
        <span>ou</span>
    </div>
    <div class="social-auth">
        <button class="btn btn-social btn-google">
            <i class="fab fa-google"></i>
            <span>Continuer avec Google</span>
        </button>
        <button class="btn btn-social btn-linkedin">
            <i class="fab fa-linkedin"></i>
            <span>Continuer avec LinkedIn</span>
        </button>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
    // Password toggles
    document.getElementById('password1-toggle').addEventListener('click', function() {
        const passwordInput = document.querySelector('input[name="password1"]');
        const icon = this.querySelector('i');
        
        if (passwordInput.type === 'password') {
            passwordInput.type = 'text';
            icon.classList.remove('fa-eye');
            icon.classList.add('fa-eye-slash');
        } else {
            passwordInput.type = 'password';
            icon.classList.remove('fa-eye-slash');
            icon.classList.add('fa-eye');
        }
    });
    
    document.getElementById('password2-toggle').addEventListener('click', function() {
        const passwordInput = document.querySelector('input[name="password2"]');
        const icon = this.querySelector('i');
        
        if (passwordInput.type === 'password') {
            passwordInput.type = 'text';
            icon.classList.remove('fa-eye');
            icon.classList.add('fa-eye-slash');
        } else {
            passwordInput.type = 'password';
            icon.classList.remove('fa-eye-slash');
            icon.classList.add('fa-eye');
        }
    });
    
    // Form validation
    document.querySelector('.auth-form').addEventListener('submit', function(e) {
        const password1 = document.querySelector('input[name="password1"]').value;
        const password2 = document.querySelector('input[name="password2"]').value;
        const terms = document.querySelector('input[name="terms"]').checked;
        
        if (password1 !== password2) {
            e.preventDefault();
            alert('Les mots de passe ne correspondent pas.');
            return;
        }
        
        if (!terms) {
            e.preventDefault();
            alert('Veuillez accepter les conditions d\'utilisation.');
            return;
        }
    });
    
    // Password strength indicator
    document.querySelector('input[name="password1"]').addEventListener('input', function() {
        const password = this.value;
        const strength = getPasswordStrength(password);
        updatePasswordStrength(strength);
    });
    
    function getPasswordStrength(password) {
        let strength = 0;
        if (password.length >= 8) strength++;
        if (/[a-z]/.test(password)) strength++;
        if (/[A-Z]/.test(password)) strength++;
        if (/[0-9]/.test(password)) strength++;
        if (/[^A-Za-z0-9]/.test(password)) strength++;
        return strength;
    }
    
    function updatePasswordStrength(strength) {
        // Implementation for password strength indicator
        console.log('Password strength:', strength);
    }
</script>
{% endblock %}