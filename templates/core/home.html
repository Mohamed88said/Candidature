{% extends 'base.html' %}
{% load static %}
{% load crispy_forms_tags %}

{% block title %}Accueil - Plateforme de Recrutement{% endblock %}

{% block content %}
<!-- Hero Section -->
<section class="hero-section">
    <div class="hero-background">
        <div class="hero-overlay"></div>
        <div class="hero-shapes">
            <div class="shape shape-1"></div>
            <div class="shape shape-2"></div>
            <div class="shape shape-3"></div>
        </div>
    </div>
    
    <div class="container">
        <div class="row align-items-center">
            <div class="col-lg-6">
                <div class="hero-content">
                    <h1 class="hero-title">
                        Trouvez l'emploi de vos <span class="text-primary">rêves</span>
                    </h1>
                    <p class="hero-subtitle">
                        Découvrez des opportunités personnalisées grâce à notre intelligence artificielle et connectez-vous avec les meilleures entreprises.
                    </p>
                    <div class="hero-actions">
                        <a href="{% url 'accounts:register' %}" class="btn btn-primary btn-lg">
                            <i class="fas fa-user-plus"></i>
                            <span>Commencer maintenant</span>
                        </a>
                        <a href="{% url 'jobs:job_list' %}" class="btn btn-outline-primary btn-lg">
                            <i class="fas fa-search"></i>
                            <span>Parcourir les offres</span>
                        </a>
                    </div>
                    <div class="hero-stats">
                        <div class="stat-item">
                            <h3>{{ total_jobs }}</h3>
                            <p>Offres d'emploi</p>
                        </div>
                        <div class="stat-item">
                            <h3>{{ total_companies }}</h3>
                            <p>Entreprises</p>
                        </div>
                        <div class="stat-item">
                            <h3>{{ total_candidates }}</h3>
                            <p>Candidats</p>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-lg-6">
                <div class="hero-image">
                    <img src="{% static 'images/hero-image.png' %}" alt="Recrutement moderne" class="img-fluid">
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Features Section -->
<section class="features-section">
    <div class="container">
        <div class="section-header">
            <h2>Pourquoi choisir notre plateforme ?</h2>
            <p>Des fonctionnalités innovantes pour révolutionner votre recherche d'emploi</p>
        </div>
        
        <div class="row">
            <div class="col-lg-4 col-md-6">
                <div class="feature-card">
                    <div class="feature-icon">
                        <i class="fas fa-magic"></i>
                    </div>
                    <h3>Matching intelligent</h3>
                    <p>Notre IA analyse votre profil et vous propose les offres les plus pertinentes</p>
                </div>
            </div>
            <div class="col-lg-4 col-md-6">
                <div class="feature-card">
                    <div class="feature-icon">
                        <i class="fas fa-video"></i>
                    </div>
                    <h3>Candidature vidéo</h3>
                    <p>Différenciez-vous avec des candidatures vidéo personnalisées</p>
                </div>
            </div>
            <div class="col-lg-4 col-md-6">
                <div class="feature-card">
                    <div class="feature-icon">
                        <i class="fas fa-comments"></i>
                    </div>
                    <h3>Chat direct</h3>
                    <p>Communiquez directement avec les recruteurs en temps réel</p>
                </div>
            </div>
            <div class="col-lg-4 col-md-6">
                <div class="feature-card">
                    <div class="feature-icon">
                        <i class="fas fa-clipboard-check"></i>
                    </div>
                    <h3>Tests en ligne</h3>
                    <p>Évaluez vos compétences avec nos tests spécialisés</p>
                </div>
            </div>
            <div class="col-lg-4 col-md-6">
                <div class="feature-card">
                    <div class="feature-icon">
                        <i class="fas fa-bell"></i>
                    </div>
                    <h3>Alertes personnalisées</h3>
                    <p>Recevez des notifications pour les offres qui vous correspondent</p>
                </div>
            </div>
            <div class="col-lg-4 col-md-6">
                <div class="feature-card">
                    <div class="feature-icon">
                        <i class="fas fa-map-marker-alt"></i>
                    </div>
                    <h3>Carte interactive</h3>
                    <p>Explorez les opportunités par localisation géographique</p>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- How It Works Section -->
<section class="how-it-works-section">
    <div class="container">
        <div class="section-header">
            <h2>Comment ça marche ?</h2>
            <p>Trois étapes simples pour trouver votre emploi idéal</p>
        </div>
        
        <div class="row">
            <div class="col-lg-4">
                <div class="step-card">
                    <div class="step-number">1</div>
                    <div class="step-content">
                        <h3>Créez votre profil</h3>
                        <p>Remplissez votre profil détaillé avec vos compétences, expérience et préférences</p>
                    </div>
                </div>
            </div>
            <div class="col-lg-4">
                <div class="step-card">
                    <div class="step-number">2</div>
                    <div class="step-content">
                        <h3>Recevez des recommandations</h3>
                        <p>Notre IA vous propose les offres les plus adaptées à votre profil</p>
                    </div>
                </div>
            </div>
            <div class="col-lg-4">
                <div class="step-card">
                    <div class="step-number">3</div>
                    <div class="step-content">
                        <h3>Postulez et connectez-vous</h3>
                        <p>Candidatez-vous et communiquez directement avec les recruteurs</p>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Latest Jobs Section -->
<section class="latest-jobs-section">
    <div class="container">
        <div class="section-header">
            <h2>Dernières offres d'emploi</h2>
            <p>Découvrez les opportunités les plus récentes</p>
        </div>
        
        <div class="row">
            {% for job in latest_jobs %}
            <div class="col-lg-6">
                <div class="job-card">
                    <div class="job-card-header">
                        <div class="job-title">
                            <h4><a href="{% url 'jobs:job_detail' job.id %}">{{ job.title }}</a></h4>
                            <p class="job-company">{{ job.company.name }}</p>
                        </div>
                        <div class="job-type">
                            <span class="type-badge">{{ job.get_job_type_display }}</span>
                        </div>
                    </div>
                    
                    <div class="job-card-body">
                        <div class="job-details">
                            <div class="job-detail">
                                <i class="fas fa-map-marker-alt"></i>
                                <span>{{ job.location }}</span>
                            </div>
                            <div class="job-detail">
                                <i class="fas fa-clock"></i>
                                <span>{{ job.get_experience_level_display }}</span>
                            </div>
                            {% if job.salary_min or job.salary_max %}
                            <div class="job-detail">
                                <i class="fas fa-euro-sign"></i>
                                <span>
                                    {% if job.salary_min and job.salary_max %}
                                        {{ job.salary_min|floatformat:0 }}€ - {{ job.salary_max|floatformat:0 }}€
                                    {% elif job.salary_min %}
                                        À partir de {{ job.salary_min|floatformat:0 }}€
                                    {% elif job.salary_max %}
                                        Jusqu'à {{ job.salary_max|floatformat:0 }}€
                                    {% endif %}
                                </span>
                            </div>
                            {% endif %}
                        </div>
                        
                        <div class="job-description">
                            <p>{{ job.description|truncatewords:20 }}</p>
                        </div>
                        
                        <div class="job-tags">
                            {% for skill in job.required_skills.all|slice:":3" %}
                            <span class="job-tag">{{ skill.name }}</span>
                            {% endfor %}
                        </div>
                    </div>
                    
                    <div class="job-card-footer">
                        <div class="job-meta">
                            <span class="job-date">{{ job.created_at|timesince }} ago</span>
                        </div>
                        <div class="job-actions">
                            <a href="{% url 'jobs:job_detail' job.id %}" class="btn btn-outline-primary btn-sm">
                                <i class="fas fa-eye"></i>
                                <span>Voir</span>
                            </a>
                            {% if user.is_authenticated %}
                            <a href="{% url 'applications:apply' job.id %}" class="btn btn-primary btn-sm">
                                <i class="fas fa-paper-plane"></i>
                                <span>Postuler</span>
                            </a>
                            {% endif %}
                        </div>
                    </div>
                </div>
            </div>
            {% endfor %}
        </div>
        
        <div class="text-center">
            <a href="{% url 'jobs:job_list' %}" class="btn btn-primary btn-lg">
                <i class="fas fa-search"></i>
                <span>Voir toutes les offres</span>
            </a>
        </div>
    </div>
</section>

<!-- Testimonials Section -->
<section class="testimonials-section">
    <div class="container">
        <div class="section-header">
            <h2>Ce que disent nos utilisateurs</h2>
            <p>Découvrez les témoignages de nos candidats et recruteurs</p>
        </div>
        
        <div class="row">
            {% for testimonial in testimonials %}
            <div class="col-lg-4">
                <div class="testimonial-card">
                    <div class="testimonial-content">
                        <p>"{{ testimonial.content }}"</p>
                    </div>
                    <div class="testimonial-author">
                        <div class="author-avatar">
                            {% if testimonial.author.candidate_profile.photo %}
                                <img src="{{ testimonial.author.candidate_profile.photo.url }}" alt="{{ testimonial.author.get_full_name }}">
                            {% else %}
                                <i class="fas fa-user"></i>
                            {% endif %}
                        </div>
                        <div class="author-info">
                            <h4>{{ testimonial.author.get_full_name|default:testimonial.author.username }}</h4>
                            <p>{{ testimonial.author.candidate_profile.profession|default:"Candidat" }}</p>
                        </div>
                    </div>
                </div>
            </div>
            {% endfor %}
        </div>
    </div>
</section>

<!-- CTA Section -->
<section class="cta-section">
    <div class="container">
        <div class="cta-content">
            <h2>Prêt à commencer votre recherche d'emploi ?</h2>
            <p>Rejoignez des milliers de candidats qui ont trouvé leur emploi idéal</p>
            <div class="cta-actions">
                <a href="{% url 'accounts:register' %}" class="btn btn-primary btn-lg">
                    <i class="fas fa-user-plus"></i>
                    <span>Créer un compte</span>
                </a>
                <a href="{% url 'core:about' %}" class="btn btn-outline-primary btn-lg">
                    <i class="fas fa-info-circle"></i>
                    <span>En savoir plus</span>
                </a>
            </div>
        </div>
    </div>
</section>
{% endblock %}

{% block extra_js %}
<script>
    // Smooth scrolling for anchor links
    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener('click', function (e) {
            e.preventDefault();
            const target = document.querySelector(this.getAttribute('href'));
            if (target) {
                target.scrollIntoView({
                    behavior: 'smooth',
                    block: 'start'
                });
            }
        });
    });
    
    // Animate elements on scroll
    const observerOptions = {
        threshold: 0.1,
        rootMargin: '0px 0px -50px 0px'
    };
    
    const observer = new IntersectionObserver((entries) => {
        entries.forEach(entry => {
            if (entry.isIntersecting) {
                entry.target.classList.add('animate-in');
            }
        });
    }, observerOptions);
    
    // Observe all feature cards and step cards
    document.querySelectorAll('.feature-card, .step-card, .job-card, .testimonial-card').forEach(card => {
        observer.observe(card);
    });
</script>
{% endblock %}